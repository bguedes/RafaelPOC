g.V().as('message').hasLabel('post', 'comment').has('creationDate', gt(date)).outE('hasCreator').inV().as('creator').hasLabel('person').select('message').inE('likes').as('like').outV().hasLabel('person').select('message', 'creator', 'like').group().by(__.project('message', 'creator').by(__.select('message')).by(__.select('creator'))).by(__.fold().project('message', 'creator', 'likeCount').by(__.unfold().select('message')).by(__.unfold().select('creator')).by(__.unfold().select('like').is(neq('  cypher.null')).count())).unfold().select(values).where(__.select('likeCount').is(gt(likeThreshold))).as('  GENERATED4').select('message').as('message').hasLabel('Message').has('creationDate', gt(123)).select('  GENERATED4').select('creator').as('creator').hasLabel('Person').select('  GENERATED4').select('likeCount').as('likeCount').select('message', 'creator', 'likeCount').project('message.id', 'message.creationDate', 'creator.firstName', 'creator.lastName', 'likeCount').by(__.select('message').choose(__.values('id'), __.values('id'), __.constant('  cypher.null'))).by(__.select('message').choose(neq('  cypher.null'), __.choose(__.values('creationDate'), __.values('creationDate'), __.constant('  cypher.null')))).by(__.select('creator').choose(neq('  cypher.null'), __.choose(__.values('firstName'), __.values('firstName'), __.constant('  cypher.null')))).by(__.select('creator').choose(neq('  cypher.null'), __.choose(__.values('lastName'), __.values('lastName'), __.constant('  cypher.null')))).by(__.select('likeCount')).order().by(__.select('likeCount'), desc).by(__.select('message.id'), asc).limit(100)