g.V().as('forum').hasLabel('forum').outE('hasMember').inV().as('person').hasLabel('person').select('forum', 'person').group().by(__.select('forum')).by(__.fold().project('forum', 'members').by(__.unfold().select('forum')).by(__.unfold().select('person').is(neq('  cypher.null')).count())).unfold().select(values).where(__.select('members').is(gt(threshold))).as('  GENERATED2').select('forum').as('forum').hasLabel('forum').select('  GENERATED2').select('members').as('members').select('forum').outE('containerOf').inV().as('post1').hasLabel('post').outE('hasTag').inV().hasLabel('tag').outE('hasType').inV().hasLabel('tagClass').has('name', eq(tagClass1)).select('forum', 'post1').group().by(__.select('forum')).by(__.fold().project('forum', 'count1').by(__.unfold().select('forum')).by(__.unfold().select('post1').dedup().is(neq('  cypher.null')).count())).unfold().select(values).as('  GENERATED7').select('forum').as('forum').hasLabel('forum').select('  GENERATED7').select('count1').as('count1').select('forum').outE('containerOf').inV().as('post2').hasLabel('post').outE('hasTag').inV().hasLabel('tag').outE('hasType').inV().hasLabel('tagClass').has('name', eq(tagClass2)).select('forum', 'count1', 'post2').group().by(__.project('forum', 'count1').by(__.select('forum')).by(__.select('count1'))).by(__.fold().project('forum', 'count1', 'count2').by(__.unfold().select('forum')).by(__.unfold().select('count1')).by(__.unfold().select('post2').dedup().is(neq('  cypher.null')).count())).unfold().select(values).as('  GENERATED12').select('forum').as('forum').hasLabel('Forum').select('  GENERATED12').select('count1').as('count1').select('  GENERATED12').select('count2').as('count2').select('forum', 'count1', 'count2').project('forum.id', 'count1', 'count2').by(__.select('forum').choose(__.values('id'), __.values('id'), __.constant('  cypher.null'))).by(__.select('count1')).by(__.select('count2')).order().by(__.select('count1').as('__GENERATED13').select('count2').choose(__.or(__.is(eq('  cypher.null')), __.select('__GENERATED13').is(eq('  cypher.null'))), __.constant('  cypher.null'), __.math('_ - __GENERATED13')).math('abs(_)'), desc).by(__.select('forum.id'), asc).limit(100)