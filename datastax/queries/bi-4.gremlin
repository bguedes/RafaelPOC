g.V().hasLabel('place').has('label', eq('Country')).has('name', eq(country)).inE('isPartOf').outV().hasLabel('place').has('label', eq('city')).inE('isLocatedIn').outV().as('person').hasLabel('person').inE('hasModerator').outV().as('forum').hasLabel('forum').outE('containerOf').inV().as('post').hasLabel('post').outE('hasTag').inV().hasLabel('tag').outE('hasType').inV().hasLabel('tagClass').has('name', eq(tagClass)).select('forum', 'person', 'post').group().by(__.project('forum.id', 'forum.title', 'forum.creationDate', 'person.id').by(__.select('forum').choose(neq('  cypher.null'), __.choose(__.values('id'), __.values('id'), __.constant('  cypher.null')))).by(__.select('forum').choose(neq('  cypher.null'), __.choose(__.values('title'), __.values('title'), __.constant('  cypher.null')))).by(__.select('forum').choose(neq('  cypher.null'), __.choose(__.values('creationDate'), __.values('creationDate'), __.constant('  cypher.null')))).by(__.select('person').choose(neq('  cypher.null'), __.choose(__.values('id'), __.values('id'), __.constant('  cypher.null'))))).by(__.fold().project('forum.id', 'forum.title', 'forum.creationDate', 'person.id', 'postCount').by(__.unfold().select('forum').choose(neq('  cypher.null'), __.choose(__.values('id'), __.values('id'), __.constant('  cypher.null')))).by(__.unfold().select('forum').choose(neq('  cypher.null'), __.choose(__.values('title'), __.values('title'), __.constant('  cypher.null')))).by(__.unfold().select('forum').choose(neq('  cypher.null'), __.choose(__.values('creationDate'), __.values('creationDate'), __.constant('  cypher.null')))).by(__.unfold().select('person').choose(neq('  cypher.null'), __.choose(__.values('id'), __.values('id'), __.constant('  cypher.null')))).by(__.unfold().select('post').dedup().is(neq('  cypher.null')).count())).unfold().select(values).order().by(__.select('postCount'), desc).by(__.select('forum.id'), asc).limit(20)