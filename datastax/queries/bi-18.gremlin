g.V().as('person').hasLabel('person').choose(__.select('person').inE('hasCreator').outV().as('message').hasLabel('post', 'comment').has('creationDate', gt(date)).has('length', lt(lengthThreshold)).emit(__.loops().is(gte(0))).repeat(__.outE('replyOf').as('  UNNAMED80').inV()).times(10).hasLabel('post').has('language', within(languages)).where(__.select('message').has('content')).optional(__.select(all, '  UNNAMED80').as('  UNNAMED80')), __.select('person').inE('hasCreator').outV().as('message').hasLabel('post', 'comment').has('creationDate', gt(date)).has('length', lt(lengthThreshold)).emit(__.loops().is(gte(0))).repeat(__.outE('replyOf').as('  UNNAMED80').inV()).times(10).hasLabel('post').has('language', within(languages)).where(__.select('message').has('content')).optional(__.select(all, '  UNNAMED80').as('  UNNAMED80')), __.constant('  cypher.null').as('message').as('  UNNAMED80')).select('person', 'message').group().by(__.select('person')).by(__.fold().project('person', 'messageCount').by(__.unfold().select('person')).by(__.unfold().select('message').is(neq('  cypher.null')).count())).unfold().select(values).as('  GENERATED5').select('person').as('person').hasLabel('person').select('  GENERATED5').select('messageCount').as('messageCount').select('messageCount', 'person').group().by(__.select('messageCount')).by(__.fold().project('messageCount', 'personCount').by(__.unfold().select('messageCount')).by(__.unfold().select('person').is(neq('  cypher.null')).count())).unfold().select(values).order().by(__.select('personCount'), desc).by(__.select('messageCount'), desc)