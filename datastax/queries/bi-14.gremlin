g.V().as('person').hasLabel('person').inE('hasCreator').outV().as('post').hasLabel('post').has('creationDate', gte(startDate)).has('creationDate', lte(endDate)).emit(__.loops().is(gte(0))).repeat(__.inE('replyOf').as('  UNNAMED50').outV()).times(10).as('reply').hasLabel('post', 'comment').has('creationDate', lte(endDate)).has('creationDate', gte(startDate)).optional(__.select(all, '  UNNAMED50').as('  UNNAMED50')).select('person', 'post', 'reply').group().by(__.project('person.id', 'person.firstName', 'person.lastName').by(__.select('person').choose(neq('  cypher.null'), __.choose(__.values('id'), __.values('id'), __.constant('  cypher.null')))).by(__.select('person').choose(neq('  cypher.null'), __.choose(__.values('firstName'), __.values('firstName'), __.constant('  cypher.null')))).by(__.select('person').choose(neq('  cypher.null'), __.choose(__.values('lastName'), __.values('lastName'), __.constant('  cypher.null'))))).by(__.fold().project('person.id', 'person.firstName', 'person.lastName', 'threadCount', 'messageCount').by(__.unfold().select('person').choose(neq('  cypher.null'), __.choose(__.values('id'), __.values('id'), __.constant('  cypher.null')))).by(__.unfold().select('person').choose(neq('  cypher.null'), __.choose(__.values('firstName'), __.values('firstName'), __.constant('  cypher.null')))).by(__.unfold().select('person').choose(neq('  cypher.null'), __.choose(__.values('lastName'), __.values('lastName'), __.constant('  cypher.null')))).by(__.unfold().select('post').dedup().is(neq('  cypher.null')).count()).by(__.unfold().select('reply').dedup().is(neq('  cypher.null')).count())).unfold().select(values).order().by(__.select('messageCount'), desc).by(__.select('person.id'), asc).limit(100)