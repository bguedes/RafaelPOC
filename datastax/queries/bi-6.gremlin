g.V().hasLabel('tag').has('name', eq(tag)).inE('hasTag').outV().as('message').hasLabel('post', 'comment').outE('hasCreator').inV().as('person').hasLabel('person').choose(__.V().hasLabel('person').outE('likes').as('like').inV().as('  GENERATED5').where(__.select('  GENERATED5').where(eq('message'))), __.V().hasLabel('person').outE('likes').as('like').inV().as('  GENERATED5').where(__.select('  GENERATED5').where(eq('message'))), __.constant('  cypher.null').as('like')).choose(__.select('message').is(neq('  cypher.null')).inE('replyOf').outV().as('comment').hasLabel('comment'), __.select('message').is(neq('  cypher.null')).inE('replyOf').outV().as('comment').hasLabel('comment'), __.constant('  cypher.null').as('comment')).select('person', 'like', 'comment', 'message').group().by(__.select('person')).by(__.fold().project('person', 'likeCount', 'replyCount', 'messageCount').by(__.unfold().select('person')).by(__.unfold().select('like').dedup().is(neq('  cypher.null')).count()).by(__.unfold().select('comment').dedup().is(neq('  cypher.null')).count()).by(__.unfold().select('message').dedup().is(neq('  cypher.null')).count())).unfold().select(values).as('  GENERATED9').select('person').as('person').hasLabel('Person').select('  GENERATED9').select('likeCount').as('likeCount').select('  GENERATED9').select('replyCount').as('replyCount').select('  GENERATED9').select('messageCount').as('messageCount').select('person', 'replyCount', 'likeCount', 'messageCount').project('person.id', 'replyCount', 'likeCount', 'messageCount', 'score').by(__.select('person').choose(neq('  cypher.null'), __.choose(__.values('id'), __.values('id'), __.constant('  cypher.null')))).by(__.select('replyCount')).by(__.select('likeCount')).by(__.select('messageCount')).by(__.constant(10).as('__GENERATED14').select('likeCount').choose(__.or(__.is(eq('  cypher.null')), __.select('__GENERATED14').is(eq('  cypher.null'))), __.constant('  cypher.null'), __.math('_ * __GENERATED14')).as('__GENERATED10').constant(2).as('__GENERATED13').select('replyCount').choose(__.or(__.is(eq('  cypher.null')), __.select('__GENERATED13').is(eq('  cypher.null'))), __.constant('  cypher.null'), __.math('_ * __GENERATED13')).as('__GENERATED11').constant(1).as('__GENERATED12').select('messageCount').choose(__.or(__.is(eq('  cypher.null')), __.select('__GENERATED12').is(eq('  cypher.null'))), __.constant('  cypher.null'), __.math('_ * __GENERATED12')).choose(__.or(__.is(eq('  cypher.null')), __.select('__GENERATED11').is(eq('  cypher.null'))), __.constant('  cypher.null'), __.math('_ + __GENERATED11')).choose(__.or(__.is(eq('  cypher.null')), __.select('__GENERATED10').is(eq('  cypher.null'))), __.constant('  cypher.null'), __.math('_ + __GENERATED10'))).order().by(__.select('score'), desc).by(__.select('person.id'), asc).limit(100)