g.V().hasLabel('person').has('id', eq(personId)).bothE('knows').dedup().by(__.path()).as('r').otherV().as('friend').select('friend', 'r').project('personId', 'firstName', 'lastName', 'friendshipCreationDate').by(__.select('friend').choose(__.values('id'), __.values('id'), __.constant('  cypher.null'))).by(__.select('friend').choose(neq('  cypher.null'), __.choose(__.values('firstName'), __.values('firstName'), __.constant('  cypher.null')))).by(__.select('friend').choose(neq('  cypher.null'), __.choose(__.values('lastName'), __.values('lastName'), __.constant('  cypher.null')))).by(__.select('r').choose(neq('  cypher.null'), __.choose(__.values('creationDate'), __.values('creationDate'), __.constant('  cypher.null')))).order().by(__.select('friendshipCreationDate'), desc).by(__.select('personId'), asc)