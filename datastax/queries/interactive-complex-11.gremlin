g.V().as('person').hasLabel('person').has('id', eq(personId)).emit(__.loops().is(gte(1))).repeat(__.bothE('knows').dedup().by(__.path()).as('  UNNAMED31').otherV()).times(2).simplePath().from('person').as('friend').where(__.select('person').where(neq('friend'))).optional(__.select(all, '  UNNAMED31').as('  UNNAMED31')).select('friend').project('friend').by(__.identity()).dedup().select('friend').as('friend').is(neq('  cypher.null')).outE('workAt').as('workAt').has('workFrom', lt(workFromYear)).inV().as('company').outE('isLocatedIn').inV().has('name', eq(countryName)).select('friend', 'company', 'workAt').project('personId', 'personFirstName', 'personLastName', 'organizationName', 'organizationWorkFromYear').by(__.select('friend').choose(__.values('id'), __.values('id'), __.constant('  cypher.null'))).by(__.select('friend').choose(neq('  cypher.null'), __.choose(__.values('firstName'), __.values('firstName'), __.constant('  cypher.null')))).by(__.select('friend').choose(neq('  cypher.null'), __.choose(__.values('lastName'), __.values('lastName'), __.constant('  cypher.null')))).by(__.select('company').choose(neq('  cypher.null'), __.choose(__.values('name'), __.values('name'), __.constant('  cypher.null')))).by(__.select('workAt').choose(neq('  cypher.null'), __.choose(__.values('workFrom'), __.values('workFrom'), __.constant('  cypher.null')))).order().by(__.select('organizationWorkFromYear'), asc).by(__.select('personId'), asc).by(__.select('organizationName'), desc).limit(10)