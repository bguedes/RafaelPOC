g.V().hasLabel('place').has('label', eq('Country')).has('name', eq(country)).inE('isPartOf').outV().hasLabel('place').has('label', eq('City')).inE('isLocatedIn').outV().as('person').hasLabel('person').inE('hasMember').outV().as('forum').hasLabel('forum').select('forum', 'person').group().by(__.select('forum')).by(__.fold().project('forum', 'numberOfMembers').by(__.unfold().select('forum')).by(__.unfold().select('person').is(neq('  cypher.null')).count())).unfold().select(values).order().by(__.select('numberOfMembers'), desc).by(__.select('forum').choose(neq('  cypher.null'), __.choose(__.values('id'), __.values('id'), __.constant('  cypher.null'))), asc).limit(100).as('  GENERATED4').select('forum').as('forum').hasLabel('forum').select('  GENERATED4').select('numberOfMembers').as('numberOfMembers').select('forum').is(neq('  cypher.null')).fold().as('popularForums').unfold().as('forum').V().as('forum').outE('hasMember').inV().as('person').hasLabel('person').choose(__.select('person').is(neq('  cypher.null')).inE('hasCreator').outV().as('post').hasLabel('post').inE('containerOf').outV().as('popularForum').hasLabel('forum').where(__.select('popularForum').where(within('popularForums'))), __.select('person').is(neq('  cypher.null')).inE('hasCreator').outV().as('post').hasLabel('post').inE('containerOf').outV().as('popularForum').hasLabel('forum').where(__.select('popularForum').where(within('popularForums'))), __.constant('  cypher.null').as('post').as('popularForum')).select('person', 'post').group().by(__.project('person.id', 'person.firstName', 'person.lastName', 'person.creationDate').by(__.select('person').choose(neq('  cypher.null'), __.choose(__.values('id'), __.values('id'), __.constant('  cypher.null')))).by(__.select('person').choose(neq('  cypher.null'), __.choose(__.values('firstName'), __.values('firstName'), __.constant('  cypher.null')))).by(__.select('person').choose(neq('  cypher.null'), __.choose(__.values('lastName'), __.values('lastName'), __.constant('  cypher.null')))).by(__.select('person').choose(neq('  cypher.null'), __.choose(__.values('creationDate'), __.values('creationDate'), __.constant('  cypher.null'))))).by(__.fold().project('person.id', 'person.firstName', 'person.lastName', 'person.creationDate', 'postCount').by(__.unfold().select('person').choose(neq('  cypher.null'), __.choose(__.values('id'), __.values('id'), __.constant('  cypher.null')))).by(__.unfold().select('person').choose(neq('  cypher.null'), __.choose(__.values('firstName'), __.values('firstName'), __.constant('  cypher.null')))).by(__.unfold().select('person').choose(neq('  cypher.null'), __.choose(__.values('lastName'), __.values('lastName'), __.constant('  cypher.null')))).by(__.unfold().select('person').choose(neq('  cypher.null'), __.choose(__.values('creationDate'), __.values('creationDate'), __.constant('  cypher.null')))).by(__.unfold().select('post').dedup().is(neq('  cypher.null')).count())).unfold().select(values).order().by(__.select('postCount'), desc).by(__.select('person.id'), asc).limit(100)