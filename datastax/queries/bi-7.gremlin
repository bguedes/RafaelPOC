g.V().as('tag').hasLabel('tag').has('name', eq(tag)).inE('hasTag').outV().hasLabel('post', 'comment').outE('hasCreator').inV().as('person1').hasLabel('person').select('tag').inE('hasTag').outV().as('message2').hasLabel('post', 'comment').outE('hasCreator').inV().as('  GENERATED7').where(__.select('  GENERATED7').where(eq('person1'))).choose(__.select('message2').is(neq('  cypher.null')).inE('likes').outV().as('person2').hasLabel('person'), __.select('message2').is(neq('  cypher.null')).inE('likes').outV().as('person2').hasLabel('person'), __.constant('  cypher.null').as('person2')).choose(__.select('person2').is(neq('  cypher.null')).inE('hasCreator').outV().hasLabel('post', 'comment').inE('likes').as('like').outV().hasLabel('person'), __.select('person2').is(neq('  cypher.null')).inE('hasCreator').outV().hasLabel('post', 'comment').inE('likes').as('like').outV().hasLabel('person'), __.constant('  cypher.null').as('like')).select('person1', 'like').group().by(__.select('person1').choose(neq('  cypher.null'), __.choose(__.values('id'), __.values('id'), __.constant('  cypher.null')))).by(__.fold().project('person1.id', 'authorityScore').by(__.unfold().select('person1').choose(neq('  cypher.null'), __.choose(__.values('id'), __.values('id'), __.constant('  cypher.null')))).by(__.unfold().select('like').dedup().is(neq('  cypher.null')).count())).unfold().select(values).order().by(__.select('authorityScore'), desc).by(__.select('person1.id'), asc).limit(100)